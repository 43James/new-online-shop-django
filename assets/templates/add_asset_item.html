{% extends "base_sidebar.html" %}
{% load form_tags %}

{% block content %}
<div class="container ">
  <h2 class="mb-3 mt-3">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</h2>
  <form method="POST" enctype="multipart/form-data" action="{% url 'assets:add_asset_item' %}" novalidate>
    {% csrf_token %}

    <fieldset class="border p-4 rounded mb-4">
      <legend class="w-auto px-2">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏´‡∏±‡∏™‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå‡πÉ‡∏´‡∏°‡πà</legend>
      <div class="row g-3">
        <div class="col-md-3">
          <label class="form-label" for="id_asset_type">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</label>
          <input type="text" name="asset_type" class="form-control {% if asset_code_form.asset_type.errors %}is-invalid{% endif %}" id="id_asset_type"
            value="{{ asset_code_form.asset_type.value|default_if_none:'' }}" placeholder="‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó (‡πÄ‡∏ä‡πà‡∏ô 1100)" required>
          {% for error in asset_code_form.asset_type.errors %}
            <div class="invalid-feedback d-block">{{ error }}</div>
          {% endfor %}
        </div>
        <div class="col-md-3">
          <label class="form-label" for="id_asset_kind">‡∏ä‡∏ô‡∏¥‡∏î</label>
          <input type="text" name="asset_kind" class="form-control {% if asset_code_form.asset_kind.errors %}is-invalid{% endif %}" id="id_asset_kind"
            value="{{ asset_code_form.asset_kind.value|default_if_none:'' }}" placeholder="‡∏ä‡∏ô‡∏¥‡∏î (‡πÄ‡∏ä‡πà‡∏ô 119)" required>
          {% for error in asset_code_form.asset_kind.errors %}
            <div class="invalid-feedback d-block">{{ error }}</div>
          {% endfor %}
        </div>
        <div class="col-md-3">
          <label class="form-label" for="id_asset_character">‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞</label>
          <input type="text" name="asset_character" class="form-control {% if asset_code_form.asset_character.errors %}is-invalid{% endif %}" id="id_asset_character"
            value="{{ asset_code_form.asset_character.value|default_if_none:'' }}" placeholder="‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ (‡πÄ‡∏ä‡πà‡∏ô 006)" required>
          {% for error in asset_code_form.asset_character.errors %}
            <div class="invalid-feedback d-block">{{ error }}</div>
          {% endfor %}
        </div>
        <div class="col-md-3">
          <label class="form-label" for="id_serial_year">‡∏•‡∏≥‡∏î‡∏±‡∏ö/‡∏õ‡∏µ</label>
          <input type="text" name="serial_year" class="form-control {% if asset_code_form.serial_year.errors %}is-invalid{% endif %}" id="id_serial_year"
            value="{{ asset_code_form.serial_year.value|default_if_none:'' }}" placeholder="‡∏•‡∏≥‡∏î‡∏±‡∏ö/‡∏õ‡∏µ (‡πÄ‡∏ä‡πà‡∏ô 10/68)" required>
          {% for error in asset_code_form.serial_year.errors %}
            <div class="invalid-feedback d-block">{{ error }}</div>
          {% endfor %}
        </div>
      </div>
    </fieldset>

    <fieldset class="border p-4 rounded">
      <legend class="w-auto px-2">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</legend>
      <div class="row g-3">
        <div class="col-md-6">
          <label class="form-label" for="id_item_name">‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</label>
          <input type="text" name="item_name" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå" class="form-control {% if asset_item_form.item_name.errors %}is-invalid{% endif %}" id="id_item_name"
            value="{{ asset_item_form.item_name.value|default_if_none:'' }}" required>
          {% for error in asset_item_form.item_name.errors %}
            <div class="invalid-feedback d-block">{{ error }}</div>
          {% endfor %}
        </div>

        <div class="col-md-3">
          <label class="form-label" for="id_category">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</label>
          <select name="subcategory" class="form-select selectpicker {% if asset_item_form.subcategory.errors %}is-invalid{% endif %}" data-live-search="true" id="id_category" required>
            <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà --</option>
            {% for category in categories %}
              <option value="" disabled>üìÇ {{ category }}</option>
              {% for sub in category.subcategories.all %}
                <option value="{{ sub.id }}" {% if asset_item_form.instance.subcategory and asset_item_form.instance.subcategory.id == sub.id %}selected{% endif %}>
                  &nbsp;&nbsp;&nbsp;‚îú {{ sub.name_sub }}
                </option>
              {% endfor %}
            {% endfor %}
          </select>
          {% for error in asset_item_form.subcategory.errors %}
            <div class="invalid-feedback d-block">{{ error }}</div>
          {% endfor %}
        </div>
        
        <div class="col-md-1">
          <label class="form-label" for="id_quantity">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</label>
          <input min="0" max="1" value="1" placeholder="‡πÉ‡∏™‡πà‡∏à‡∏≥‡∏ô‡∏ß‡∏ô" type="number" name="quantity" class="form-control {% if asset_item_form.quantity.errors %}is-invalid{% endif %}" id="id_quantity"
            value="{{ asset_item_form.quantity.value|default_if_none:'' }}" readonly >
          {% for error in asset_item_form.quantity.errors %}
            <div class="invalid-feedback d-block">{{ error }}</div>
          {% endfor %}
        </div>

        <div class="col-md-2">
          <label class="form-label" for="id_unit">‡∏´‡∏ô‡πà‡∏ß‡∏¢</label>
          <input type="text" name="unit" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏´‡∏ô‡πà‡∏ß‡∏¢" class="form-control {% if asset_item_form.unit.errors %}is-invalid{% endif %}" id="id_unit"
            value="{{ asset_item_form.unit.value|default_if_none:'' }}" required>
          {% for error in asset_item_form.unit.errors %}
            <div class="invalid-feedback d-block">{{ error }}</div>
          {% endfor %}
        </div>

        <div class="col-md-3">
          <label class="form-label" for="id_purchase_price">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏à‡∏±‡∏î‡∏ã‡∏∑‡πâ‡∏≠</label>
          <input type="number" min="0" name="purchase_price" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏Ñ‡∏≤" class="form-control {% if asset_item_form.purchase_price.errors %}is-invalid{% endif %}" id="id_purchase_price"
            value="{{ asset_item_form.purchase_price.value|default_if_none:'' }}" required>
          {% for error in asset_item_form.purchase_price.errors %}
            <div class="invalid-feedback d-block">{{ error }}</div>
          {% endfor %}
        </div>

        <div class="col-md-3">
          <label class="form-label" for="id_purchase_date">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡∏ã‡∏∑‡πâ‡∏≠</label>
          <input type="date" name="purchase_date" class="form-control {% if asset_item_form.purchase_date.errors %}is-invalid{% endif %}" id="id_purchase_date"
            value="{{ asset_item_form.purchase_date.value|default_if_none:'' }}" required>
          {% for error in asset_item_form.purchase_date.errors %}
            <div class="invalid-feedback d-block">{{ error }}</div>
          {% endfor %}
        </div>

        <div class="col-md-2">
          <label class="form-label" for="id_fiscal_year">‡∏õ‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</label>
          <input type="number" min="2000" name="fiscal_year" placeholder="‡πÉ‡∏™‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏µ ‡∏Ñ.‡∏®." class="form-control {% if asset_item_form.fiscal_year.errors %}is-invalid{% endif %}" id="id_fiscal_year"
            value="{{ asset_item_form.fiscal_year.value|default_if_none:'' }}" required>
          {% for error in asset_item_form.fiscal_year.errors %}
            <div class="invalid-feedback d-block">{{ error }}</div>
          {% endfor %}
        </div>

        <div class="col-md-2">
          <label class="form-label" for="id_lifetime">‡∏≠‡∏≤‡∏¢‡∏∏‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (‡∏õ‡∏µ)</label>
          <input type="number" min="1" name="lifetime" placeholder="‡∏≠‡∏≤‡∏¢‡∏∏‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô" class="form-control {% if asset_item_form.lifetime.errors %}is-invalid{% endif %}" id="id_lifetime"
            value="{{ asset_item_form.lifetime.value|default_if_none:'' }}" required>
          {% for error in asset_item_form.lifetime.errors %}
            <div class="invalid-feedback d-block">{{ error }}</div>
          {% endfor %}
        </div>

        <div class="col-md-2">
          <label class="form-label" for="id_used_years">‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß (‡∏õ‡∏µ)</label>
          <input type="number" min="1" name="used_years" placeholder="‡πÉ‡∏ä‡πâ‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏µ‡πà‡∏õ‡∏µ" class="form-control {% if asset_item_form.used_years.errors %}is-invalid{% endif %}" id="id_used_years"
            value="{{ asset_item_form.used_years.value|default_if_none:'' }}" required>
          {% for error in asset_item_form.used_years.errors %}
            <div class="invalid-feedback d-block">{{ error }}</div>
          {% endfor %}
        </div>

        <div class="col-md-3">
          <label class="form-label" for="id_responsible_person">‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡∏î‡∏π‡πÅ‡∏•/‡∏Å‡∏≥‡∏Å‡∏±‡∏ö</label>
          <input type="text" name="responsible_person" class="form-control {% if asset_item_form.responsible_person.errors %}is-invalid{% endif %}" id="id_responsible_person"
            value="{{ asset_item_form.responsible_person.value|default_if_none:'' }}" placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•" required>
          {% for error in asset_item_form.responsible_person.errors %}
            <div class="invalid-feedback d-block">{{ error }}</div>
          {% endfor %}
        </div>

        <div class="col-md-3">
          <label class="form-label" for="id_brand_model">‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠/‡∏£‡∏∏‡πà‡∏ô</label>
          <input type="text" name="brand_model" placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠" class="form-control {% if asset_item_form.brand_model.errors %}is-invalid{% endif %}" id="id_brand_model"
            value="{{ asset_item_form.brand_model.value|default_if_none:'' }}" required>
          {% for error in asset_item_form.brand_model.errors %}
            <div class="invalid-feedback d-block">{{ error }}</div>
          {% endfor %}
        </div>

        <div class="col-md-3">
          <label class="form-label" for="id_storage_location">‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö</label>
          <select name="storage_location" class="form-select selectpicker {% if asset_item_form.storage_location.errors %}is-invalid{% endif %}" data-live-search="true" id="id_storage_location" required>
            <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö --</option>
            {% for value, label in asset_item_form.storage_location.field.choices %}
              {% if value != "" and label != "---------" %}
                <option value="{{ value }}" {% if asset_item_form.storage_location.value == value %}selected{% endif %}>{{ label }}</option>
              {% endif %}
            {% endfor %}
          </select>
          {% for error in asset_item_form.storage_location.errors %}
            <div class="invalid-feedback d-block">{{ error }}</div>
          {% endfor %}
        </div>

        <div class="col-md-2">
          <label class="form-label" for="id_damage_status">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ä‡∏≥‡∏£‡∏∏‡∏î</label>
          <select name="damage_status" class="form-select selectpicker {% if asset_item_form.damage_status.errors %}is-invalid{% endif %}" data-live-search="true" id="id_damage_status">
            <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ --</option>
            {% for value, label in asset_item_form.damage_status.field.choices %}
              {% if value != "" and label != "---------" %}
                <option value="{{ value }}" {% if asset_item_form.damage_status.value == value %}selected{% endif %}>{{ label }}</option>
              {% endif %}
            {% endfor %}
          </select>
          {% for error in asset_item_form.damage_status.errors %}
            <div class="invalid-feedback d-block">{{ error }}</div>
          {% endfor %}
        </div>

        <div class="col-md-4">
          <label class="form-label" for="id_asset_image">‡πÅ‡∏ô‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</label>
          <input type="file" name="asset_image" class="form-control {% if asset_item_form.asset_image.errors %}is-invalid{% endif %}" id="id_asset_image">
          {% for error in asset_item_form.asset_image.errors %}
            <div class="invalid-feedback d-block">{{ error }}</div>
          {% endfor %}
        </div>

        <div class="col-md-12">
          <label class="form-label" for="id_notes">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</label>
          <textarea name="notes" class="form-control {% if asset_item_form.notes.errors %}is-invalid{% endif %}" id="id_notes" rows="2"
            placeholder="‡∏ñ‡πâ‡∏≤‡∏°‡∏µ...">{{ asset_item_form.notes.value|default_if_none:'' }}</textarea>
          {% for error in asset_item_form.notes.errors %}
            <div class="invalid-feedback d-block">{{ error }}</div>
          {% endfor %}
        </div>
      </div>

      <div class="mt-4 mb-3 d-flex justify-content-center">
        <a onclick="history.back()" class="btn btn-secondary">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</a>
        <button type="submit" class="btn btn-primary ms-2"
          onclick="this.disabled=true; this.innerHTML='‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...'; this.form.submit();">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
      </div>
    </fieldset>
  </form>

  <script>
    $(document).ready(function() {
        $('.datepicker').datepicker({
            format: 'dd/mm/yyyy', // ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ö‡∏ô input
            language: 'th',
            autoclose: true,
            todayHighlight: true,
            thaiyear: true // ‚úÖ ‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏õ‡πá‡∏ô ‡∏û.‡∏®.
        });
    });
</script>
</div>
{% endblock %}